!function($){var t={};t.Window=new function(){var e=this,a=[".back-to-top",".processing-overlay .global-notice.processing"];e.testTouch=function(){return!!("ontouchstart"in window)||!!("onmsgesturechange"in window)||-1!=navigator.appVersion.toLowerCase().indexOf("mobile")},e.testFixed=function(){var a=!0,i=$("<div id='a1'>").css({position:"fixed",width:1,height:1,top:"50%"});$("body").append(i),a=i.offset().top>=$(window).height()/2-1&&i.offset().top<=$(window).height()/2+1?!0:!1,i.remove(),t.Window.testFixedResult(!e.isBaselinePhone())},e.baselineSupportTest=function(){var t=window.navigator.userAgent,e=/(Android 4)/,a=/(iPhone|iPad)/;t.match(e)&&window.FileReader?$("html").addClass("android-modern"):t.match(a)&&window.FileReader&&$("html").addClass("ios-modern"),isBaselinePhone()&&$("html").addClass("baseline")},e.isBaselinePhone=function(){var t=!1,e=$("html").attr("data-current-breakpoint");return-1!==["medium","small"].indexOf(e)&&($("html").hasClass("android-modern")||$("html").hasClass("ios-modern")||($("html").hasClass("notouch")&&"small"===e?t=!0:$("html").hasClass("touch")&&(t=!0))),t},e.updateFixedResult=function(){$.each(a,function(t,e){var e=$(e);a[t]=e,e.removeAttr("style"),e.removeAttr("data-pos-top"),e.removeAttr("data-pos-type");var i=!e.is(":visible");i&&e.toggle(0),e.css({position:"absolute"});var n=parseFloat(e.css("top"))/e.offsetParent().height();e.offsetParent().height("+=2"),n==parseFloat(e.css("top"))/e.offsetParent().height()?(e.attr("data-pos-top",n),e.attr("data-pos-type","percent")):(e.attr("data-pos-top",parseFloat(e.css("top"))),e.attr("data-pos-type","static"),e.css("margin-top",parseFloat(e.css("top")))),e.offsetParent().height(""),e.css("top",0),i&&e.toggle(0)}),a=$(a),t.Window.enableScrollHandlers(!0,a)},e.testFixedResult=function(e){e||($.each(a,function(t,e){var e=$(e);a[t]=e;var i=!e.is(":visible");i&&e.toggle(0),e.css({position:"absolute"});var n=parseFloat(e.css("top"))/e.offsetParent().height();e.offsetParent().height("+=2"),n==parseFloat(e.css("top"))/e.offsetParent().height()?(e.attr("data-pos-top",n),e.attr("data-pos-type","percent")):(e.attr("data-pos-top",parseFloat(e.css("top"))),e.attr("data-pos-type","static"),e.css("margin-top",parseFloat(e.css("top")))),e.offsetParent().height(""),e.css("top",0),i&&e.toggle(0)}),a=$(a),t.Window.enableScrollHandlers(!0,a))},e.enableScrollHandlers=function(t,a){t?($(window).scroll(function(){e.scrollHandler(a)}),$(window).bind("orientationchange",function(t){e.orientationHandler(a)})):$(window).unbind("scroll")},e.scrollHandler=function(t){t.each(function(){var t=$(this);t.is(":visible")&&t.attr("data-pos-type")&&("percent"==t.attr("data-pos-type")?t.css("margin-top",parseFloat(t.attr("data-pos-top"))*$(window).height()+$(window).scrollTop()):t.css("margin-top",parseFloat(t.attr("data-pos-top"))/2+$(window).scrollTop()))})},e.orientationHandler=function(t){$.each(a,function(t,e){var e=$(e);a[t]=e;var i=!e.is(":visible");if(i&&e.toggle(0),e.css({position:"absolute"}),0!=parseFloat(e.css("top"))){var n=parseFloat(e.css("top"))/e.offsetParent().height();e.offsetParent().height("+=2"),n==parseFloat(e.css("top"))/e.offsetParent().height()?(e.attr("data-pos-top",n),e.attr("data-pos-type","percent")):(e.attr("data-pos-top",parseFloat(e.css("top"))),e.attr("data-pos-type","static"),e.css("margin-top",parseFloat(e.css("top")))),e.offsetParent().height(""),e.css("top",0),i&&e.toggle(0)}})}},t.Widget=new function(){var e=this;e.init=function(){t.Window.testFixed(),$("*[data-widget-type]").each(function(){var a,i=$(this),n=i.attr("data-widget-type");switch(n){case"transaction-drawer-prompt":i.on("click",t.Transaction.Drawers.open);break;case"action-prompt-target":i.closest(".transaction").length>0&&t.Transaction.init(i);break;case"module-message":a=e.ModuleMessage,t.Widget.ProcessingOverlay.init(i),i.on("click",a.reveal);break;case"confirm-modifier":a=e.ConfirmModifier,i.on("click",a.populate);break;case"transaction-summary":e.enhanceTransactionDetailLink(i);break;case"back-to-top":a=t.BackToTop,a.init(i),i.on("click",a.clickHandler);break;case"date-filter":a=t.Async.DateFilter,a.init(i);break;case"load-more":a=t.Async.LoadMore,a.init(i);break;case"processing-overlay":a=e.ProcessingOverlay,a.init(i);case"interstitial-message":a=e.InterstitialMessage,i.on("click",a.reveal);break;case"transaction-detail-submit":a=e.TransactionDetailActions,i.on("click",a.submitForm);break;case"load-more":a=t.Async.LoadMore,a.init(i)}}),$('a[href="#"]').click(function(t){t.preventDefault()}),Date.prototype.toMMDDYYYYString=function(){return isNaN(this)?"NaN":[this.getMonth()>8?this.getMonth()+1:"0"+(this.getMonth()+1),this.getDate()>9?this.getDate():"0"+this.getDate(),this.getFullYear()].join("/")},Date.prototype.toYYYYMMDDString=function(){return isNaN(this)?"NaN":[this.getFullYear(),this.getMonth()>8?this.getMonth()+1:"0"+(this.getMonth()+1),this.getDate()>9?this.getDate():"0"+this.getDate()].join("-")}},e.enhanceTransactionDetailLink=function(e){var a,i=e,n=i.find(".transaction-inner"),o=i.find("a.detail-link");n.length>0&&o.length>0&&(a=o.attr("href"),a.length>0&&($(n).addClass("full-link"),$(n).on("click",function(e){var a=$(this),i=e.srcElement.className;if("learnlimit"!=i){var n=a.closest("[data-transaction-id]");t.Async.TransactionDetailRequest(t.Transaction.Router,n)}})))},e.InterstitialMessage=new function(){this.reveal=function(e){var a=$(this),i=a.closest("[data-transaction-id]");t.Async.TransactionDetailRequest(t.Transaction.Router,i)}},e.ModuleMessage=new function(){this.reveal=function(a,i){var n=$(this),o=n.closest("[data-transaction-id]"),s=n.closest("[data-transaction-id]"),r=0==s.closest(".notification").length?!0:!1;r?(e.ProcessingOverlay.show(),t.Async.TransactionRequest(t.Transaction.Router,o)):t.Async.NotificationRequest(t.Transaction.Router,o)}},e.ProcessingOverlay=new function(){var e=this,a=null,i=null,n=null;e.init=function(t){a=t,i=t.find(".global-overlay"),n=t.find(".global-notice.processing"),$("body").css("position","relative")},e.show=function(e,a){void 0===e&&(e=!0),i.fadeTo(300,.5,function(){t.Window.scrollHandler(n),a&&a.call()}),e&&n.fadeIn(300),t.BackToTop.forceHidden(!0)},e.hide=function(e){i.fadeOut(300,function(){e&&e.call(),t.BackToTop.forceHidden(!1)}),n.fadeOut(300)},e.fullscreen=function(t){void 0===t&&(t=!0),t?(a.closest("#page-content").css("position",""),void 0===n.attr("data-pos-top")?n.css("top",30):(n.attr("data-pos-top",30),n.attr("data-pos-type","static"))):($("body").css("position",""),a.closest("#page-content").css("position","relative"),void 0===n.attr("data-pos-top")?n.css("top",30):(n.css({"margin-top":0,top:0}),n.attr("data-pos-top",30),n.attr("data-pos-type","static")))}}},t.Transaction=new function(){var e=this;e.init=function(t){var e=t,a=e.attr("data-widget-name"),i=e.closest(".container"),n=i.find("[data-widget-type=action-prompt-target][data-widget-name="+a+"]"),o=$(n).find("*[data-widget-action=cancel]"),s=void 0!=e.attr("data-transition-type")?e.attr("data-transition-type"):"toggle",r=i.find(".adjust-link");o.on("click",function(){var t=i.offset().top<$(window).scrollTop()?i.offset().top:$(window).scrollTop(),a=e.closest(".container").find("[data-widget-property=replaced-by-prompt]");n.fadeOut(300,function(){a.fadeIn(300,function(){$(this).addClass("active")}),$(this).removeClass("active")}),i.find(".prompt-revealed").removeClass("prompt-revealed"),r.removeClass("adjust-active").addClass("adjust-inactive"),$("html, body").animate({scrollTop:t},200)})},e.Drawers=new function(){var t=this,e=300,a=300;t.closeOne=function(t){t.find(".prompt-box.active").fadeOut(this.outDelay),$("html, body").animate({scrollTop:t.offset().top<$(window).scrollTop()?container.offset().top:$(window).scrollTop()},200)},t.restoreToOriginalState=function(t){var i,n;i=t.find("[data-widget-property=replaced-by-prompt]"),n=t.find(".prompt-box.active"),n.fadeOut(e,function(){i.fadeIn(a,function(){i.addClass("active")}),n.removeClass("active")})},t.open=function(t,e){var a,i,n,o=void 0!==e?e:$(this),s=o.closest("[data-transaction-id]"),r=s.attr("data-transaction-id"),d=o.attr("data-widget-name"),l=$('[data-transaction-id="'+r+'"]'),c=this.outDelay,p=this.inDelay;t&&(t.preventDefault(),t.stopPropagation()),o.hasClass("prompt-revealed")?(a=s.find("[data-widget-property=replaced-by-prompt]"),i=s.find('[data-widget-type=action-prompt-target][data-widget-name="'+d+'"]'),o.removeClass("prompt-revealed")):(a=s.find('[data-widget-type=action-prompt-target][data-widget-name="'+d+'"]'),n=s.find(".active.prompt-box"),n.length>0?i=n:(i=s.find("[data-widget-property=replaced-by-prompt]"),c=0),o.addClass("prompt-revealed")),i.fadeOut(c,function(){a.fadeIn(p,function(){a.addClass("active")}),i.removeClass("active")})}},e.Router=function(e,a,i,n,o,s){var r=e.find("[data-widget-type=module-message-alert]"),d=e.find("*[data-widget-type=module-message-overlay]"),l=3300,c,p;if(t.Widget.ProcessingOverlay.hide(),"pass"==a||"decline"==a)"pass"==a?(p="complete-dynamic",e.find("[data-widget-property=expiration-date]").addClass("inactive")):"decline"==a&&(p="declined-trans",e.find("[data-widget-property=expiration-date]").html("Declined")),e.addClass(p),s?(d.delay(600).fadeTo(300,.7).delay(3500).fadeOut(300),r.addClass("global-notice").removeClass("global-error").delay(600).fadeIn(300).delay(2500).fadeOut(300)):(d.fadeTo(300,.7).delay(2500).fadeOut(300),r.addClass("global-notice").removeClass("global-error").fadeIn(300).delay(2500).fadeOut(300)),r.find("[data-widget-property=message-body]").html(i),this.Drawers.closeOne(e),e.find("[data-widget-property=change-prompt]").fadeTo(500,0),"decline"!=a&&e.find(".trans-label").fadeTo(500,0),n!==!1&&window.setTimeout(function(){window.location=n},l);else if("fail"==a)r.removeAttr("class").addClass("global-error message transaction active"),r.find("[data-widget-property=message-body]").html(i),this.Drawers.restoreToOriginalState(e);else if("fail-inline"==a){var f=e.find('[name="'+fakeResponse.fieldActive+'"]');f.addClass("error"),f.siblings(".contextual-error").addClass("active")}else"interstitial"==a&&(c=e.find("[data-widget-type=action-prompt-target][data-widget-name=drawer-interstitial]"),c.find("[data-widget-property=message-body]").html(i),t.Transaction.Drawers.open(!1,c))}},t.Async=new function(){var e=this,a=!1,i=!0,n=20,o=!1,s=2500;e.init=function(){},e.LoadMoreRequest=function(t){setTimeout(t,s)},e.FilterRequest=function(t,e,a){setTimeout(t,s)},e.NotificationRequest=function(e,a){e.call(t.Transaction,a,fakeResponse.status,fakeResponse.message,fakeResponse.route,fakeResponse.destinationDrawer,!1)},e.TransactionRequest=function(e,a){var i=a.find(".prompt-box.active");setTimeout(function(){e.call(t.Transaction,a,fakeResponse.status,fakeResponse.message,fakeResponse.route,fakeResponse.destinationDrawer,!0)},s)},e.TransactionDetailRequest=function(t,a,i){var n=a.find("[data-widget-name=transaction-detail] form");e.SendRequest(a,n,i)},e.SendRequest=function(t,e,a){$(e).valid()&&($("input",e).each(function(){this.id.length>0&&($(this).attr("name",this.id),"ActionSource"===$(this).attr("id")&&void 0!==a?$(this).val(a):"Message"===$(this).attr("id")&&$(this).val(t.find('textarea[value!=""]#Message').val()))}),e.submit())},e.DateFilter=new function(){var a=this;a.SA=e;var n,s=[],r=!0,d=!1,l=["",""],c=null,p,f=0;a.init=function(t){if(n=t,r=a.getDateCapabilities(),p=!0,s=n.find("[data-widget-property=date-input]"),r)for(var e=0;e<s.length;e++)try{s[e].type="date"}catch(i){}else s.datepicker({maxDate:"0",yearRange:"-10:0",onClose:a.pickerCloseHandler});a.attachHandlers(),$("[data-widget-property=input-container]").each(function(){var t=$(this).find("input"),e=$(this).find("label");e.find("span").attr("data-text",e.find("span").text()),inputVal=$.trim(t.val()),inputVal&&e.hide(),t.focus(function(){if(c!=t[0]&&(c=t[0],$.trim(t.val())||e.find("span").text(""),!r)){var a=t[0]==s[0]?"maxDate":"minDate",i=null;i="maxDate"==a?$.trim(s[1].value)&&s[1].value<$.datepicker.formatDate("mm/dd/yyyy",new Date)?s[1].value:0:$.trim(s[0].value)?s[0].value:null,t.datepicker("option",a,i)}}),t.blur(function(){var i=!!$.datepicker._lastInput&&$.datepicker._lastInput==t[0];i||(c=null),setTimeout(a.placeholderHandler,200,t,e)})})},a.getDateCapabilities=function(){return t.Window.testTouch()},a.attachHandlers=function(){s.keyup(a.keyHandler),n.find("[data-widget-property=filter-open]").click(a.openFilters),n.find("[data-widget-property=filter-close]").click(a.closeFilters),n.find("[data-widget-property=filter-apply]").click(a.applyFilters),n.find("[data-widget-property=filter-reset]").click(a.resetFilters),n.find("[data-widget-property=filter-clear]").click(a.clearFilters)},a.keyHandler=function(t){13==t.keyCode&&a.dateValidate()},a.openFilters=function(){p=!0,l[0]&&r&&(s[0].value=l[0]),l[1]&&r&&(s[1].value=l[1]),a.placeholderHandler($(s[0]),$(s[0]).closest("[data-widget-property=input-container]").find("label")),a.placeholderHandler($(s[1]),$(s[1]).closest("[data-widget-property=input-container]").find("label")),$("[data-widget-property=date-filter-closed]").fadeOut(300,function(){$("[data-widget-property=date-filter-open]").fadeIn(300).css("display","inline-block")}),$("[data-widget-property=filter-result-count]").fadeOut(300)},a.closeFilters=function(){c=null,$("[data-widget-property=filter-text]").text(d?new Date(l[0]+"T12:00").toMMDDYYYYString()+" - "+new Date(l[1]+"T12:00").toMMDDYYYYString():"Filter By Date"),$("[data-widget-property=date-filter-open]").fadeOut(300,function(){$("[data-widget-property=date-filter-closed]").fadeIn(300),d&&$("[data-widget-property=filter-result-count]").fadeIn(300)})},a.applyFilters=function(){$(this).hasClass("disabled")||o||(o=d=!0,a.processFilters(),l=[s[0].value,s[1].value])},a.clearFilters=function(){$("[data-widget-property=input-container]").each(function(){var t=$(this).find("input"),e=$(this).find("label");t.val(""),e.find("span").text(e.find("span").attr("data-text"))}),$("[data-widget-property=filter-result-count]").fadeOut(300),d=!1,l=["",""],a.processFilters(),$("[data-widget-property=filter-text]").text("Filter By Date")},a.resetFilters=function(){$("[data-widget-property=input-container]").each(function(){var t=$(this).find("input"),e=$(this).find("label");t.val(""),e.find("span").text(e.find("span").attr("data-text"))}),d&&(p=!1,a.processFilters(),l=["",""],d=!1)},a.placeholderHandler=function(t,e){var i=!!$.datepicker._lastInput&&$.datepicker._lastInput==t[0];a.dateValidate(),$.trim(t.val())?e.find("span").text(""):i||t[0]==c||e.find("span").text(e.find("span").attr("data-text"))},a.dateValidate=function(){var t=0;s.each(function(){""==this.value?a.removeError($(this)):"date"!=this.type&&!/[0-9]{1,2}\/[0-9]{1,2}\/[0-9]{4}/.test(this.value)||isNaN(new Date(this.value).getTime())?(f=0,a.triggerError($(this),"Please enter a valid date")):(t++,a.removeError($(this)))}),2==t?$("[data-widget-property=filter-apply]").removeClass("disabled"):$("[data-widget-property=filter-apply]").addClass("disabled")},a.processFilters=function(){i=!1,t.Widget.ProcessingOverlay.fullscreen(!1),t.Widget.ProcessingOverlay.show(),e.FilterRequest(a.PROTO_changeItems,s[0],s[1])},a.applyFiltersComplete=function(){t.Widget.ProcessingOverlay.hide(t.Widget.ProcessingOverlay.fullscreen),d&&$("[data-widget-property=filter-result-count]").fadeIn(300),i=!d,o=!1,p&&a.closeFilters()},a.pickerCloseHandler=function(){var t=$(this),e=$(this).closest("[data-widget-property=input-container]").find("label");setTimeout(a.placeholderHandler,200,t,e),this==s[0]&&""==s[1].value&&""!=this.value&&setTimeout(function(){$(s[1]).datepicker("show")},100)},a.triggerError=function(t,e){t.addClass("error"),t.parent().find(".contextual-error").text(e).show(0),$(".sb-filters .grid-row").addClass("error-state"),f++},a.removeError=function(t){t.removeClass("error"),t.parent().find(".contextual-error").hide(0),f--,0>f&&$(".sb-filters .grid-row").removeClass("error-state")},a.PROTO_changeItems=function(t){a.applyFiltersComplete()}},e.LoadMore=new function(){var t=this;t.SA=e;var o=null;t.init=function(e){o=e,$(".sm-content-box.transaction-dt.related-trans").children().length>=20&&$(window).scroll(t.scrollHandler)},t.scrollHandler=function(){var e=$(window).scrollTop();e>=$(document).height()-$(window).height()-$(".footer").height()&&!a&&i&&t.doLoad()},t.doLoad=function(){a=!0,$(o).fadeIn(300),$("[data-widget-property=load-more-text]").text("Loading Transactions "+(n+1)+" to "+(n+=30)),e.LoadMoreRequest(t.PROTO_addItems)},t.PROTO_addItems=function(){for(var e,a=0;15>a;a++)e+=insertHTML;var i=$(e);$(".sm-content-box.transaction-dt.related-trans").append(i),t.loadComplete()},t.loadComplete=function(){$(o).fadeOut(300),a=!1}}},t.BackToTop=new function(){var t=this,e=null,a=2e3,i=!1;t.init=function(){$(window).resize(t.resizeHandler),$(window).scroll(t.scrollHandler)},t.scrollHandler=function(){if(!i){var n=$(window).scrollTop();n>$(".subnav").height()+$(".subnav").offset().top?$(window).width()<=896?(e&&clearTimeout(e),e=setTimeout(t.visibilityHandler,a),$(".back-to-top").css({display:"block",opacity:1})):t.visibilityHandler(!1):t.visibilityHandler(!0)}},t.resizeHandler=function(){$(window).width()<=896?$(".back-to-top").css(e?{display:"block",opacity:1}:{display:"none"}):t.scrollHandler()},t.visibilityHandler=function(t){e&&clearTimeout(e),e=null,void 0===t&&(t=$(window).width()<=896),t?$(".back-to-top").fadeOut(300):$(".back-to-top").css({display:"block",opacity:1})},t.forceHidden=function(t){i=t},t.clickHandler=function(t){$("html, body").animate({scrollTop:0},200)}},$(document).ready(function(){this.console||(this.console={log:function(){}}),t.Widget.init()}),$(window).resize(function(){t.Window.updateFixedResult()})}(jQuery);